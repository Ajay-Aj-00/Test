# authw
* For this we have to make `user=admin & role=admin`.But the input is only taking for user.
* Ok! But why can't we inject the `role=admin` using username input.
* That is the way of Exploiting the authw(simply Injecting the role).
### Exploiting
* ![aw1](https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/www.png)
* But in `register function` we can observe the `username = "username=" + username + ":role=ordinary"`
* It is adding `username=` to our input .So there is no need of 'username=' string
* **Payload = 'admin:role=admin\x07\x07\x07\x07\x07\x07\x07'** Which is given as Input (Payload != 'admin').So no Problem
* If we use Payload as Input Then it returns `iv+encypt(pad('username=admin:role=admin\x07\x07\x07\x07\x07\x07\x07'+':role=ordinary'))` in hex as cookie
* **It is a Block Cipher encryption**
> 1st Block : (iv)<br>
> 2nd Block : ('username=admin:r')<br>
> 3rd Block : ('ole=admin\x07\x07\x07\x07\x07\x07\x07')<br>
> 4th Block : (':role=ordinary\x02\x02')<br>
* '\x07'\*7 padding helped us to move the ':role=ordinary' into 4th Block.
* Now we get the Encrypted text(Combinaition of 4 blocks) as hex in cookie.(Single Block length in cookie is 32,len(cookie)=128)
* So In order to Terminate ':role=ordinary' part we can Simply remove the 4th block of cookie
* `cookie = cookie[:96]` . Cookie we had now is iv+encryption('username=admin:role=admin\x07\x07\x07\x07\x07\x07\x07')
* That's it. Now we can use this cookie To get **Writing authorization**. 
